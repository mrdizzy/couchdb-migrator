{"ts":1344589035125,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1344589075134,"patch":[[{"diffs":[[1,"var docs = require('./../../config/database').documents,\r\n    db = require('./../../config/database').db;\r\n\r\nvar resetDb = function(callback) {\r\n    db.destroy(function(error, response) {\r\n        if (error) {\r\n            callback(error, response);\r\n        }\r\n        else {\r\n            createDb(callback);\r\n        }\r\n    })\r\n}\r\n\r\nvar createDb = function(callback) {\r\n    db.create(function(err, res) {\r\n        if (err) {\r\n            callback(err, res);\r\n        }\r\n        else {\r\n            db.save(docs, function(err, res) {\r\n                if (err) {\r\n                    callback(err, res);\r\n                }\r\n                else {\r\n                    setUpSecurity(function(error, response) {\r\n                        if (error) {\r\n                            callback(error, response)\r\n                        }\r\n                        else {\r\n                            callback(error, response)\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n        }\r\n    })\r\n}\r\n// Defaults to admin only allowing access to database\r\n\r\nfunction setUpSecurity(callback) {\r\n    db.save(\"_security\", {\r\n        \"admins\": {\r\n            \"names\": [],\r\n            \"roles\": [\"admin\"]\r\n        },\r\n        \"members\": {\r\n            \"names\": [],\r\n            \"roles\": [\"admin\"]\r\n        }\r\n    }, callback)\r\n}\r\n\r\nmodule.exports.db = db;\r\nmodule.exports.createDb = createDb;\r\nmodule.exports.resetDb = resetDb;"]],"start1":0,"start2":0,"length1":0,"length2":1447}]],"length":1447,"saved":false}
