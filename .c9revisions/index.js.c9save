{"ts":1344589035125,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1344589075134,"patch":[[{"diffs":[[1,"var docs = require('./../../config/database').documents,\r\n    db = require('./../../config/database').db;\r\n\r\nvar resetDb = function(callback) {\r\n    db.destroy(function(error, response) {\r\n        if (error) {\r\n            callback(error, response);\r\n        }\r\n        else {\r\n            createDb(callback);\r\n        }\r\n    })\r\n}\r\n\r\nvar createDb = function(callback) {\r\n    db.create(function(err, res) {\r\n        if (err) {\r\n            callback(err, res);\r\n        }\r\n        else {\r\n            db.save(docs, function(err, res) {\r\n                if (err) {\r\n                    callback(err, res);\r\n                }\r\n                else {\r\n                    setUpSecurity(function(error, response) {\r\n                        if (error) {\r\n                            callback(error, response)\r\n                        }\r\n                        else {\r\n                            callback(error, response)\r\n                        }\r\n                    })\r\n                }\r\n            })\r\n        }\r\n    })\r\n}\r\n// Defaults to admin only allowing access to database\r\n\r\nfunction setUpSecurity(callback) {\r\n    db.save(\"_security\", {\r\n        \"admins\": {\r\n            \"names\": [],\r\n            \"roles\": [\"admin\"]\r\n        },\r\n        \"members\": {\r\n            \"names\": [],\r\n            \"roles\": [\"admin\"]\r\n        }\r\n    }, callback)\r\n}\r\n\r\nmodule.exports.db = db;\r\nmodule.exports.createDb = createDb;\r\nmodule.exports.resetDb = resetDb;"]],"start1":0,"start2":0,"length1":0,"length2":1447}]],"length":1447,"saved":false}
{"contributors":[],"silentsave":false,"ts":1349389027205,"patch":[[{"diffs":[[0,",\r\n    d"],[-1,"b"],[1,"atabases"],[0," = requi"]],"start1":55,"start2":55,"length1":17,"length2":24},{"diffs":[[0,"tabase')"],[-1,".db"],[0,";\r\n\r\nvar"]],"start1":100,"start2":100,"length1":19,"length2":16},{"diffs":[[0,"etDb = function("],[1,"database_name, "],[0,"callback) {\r\n   "]],"start1":120,"start2":120,"length1":32,"length2":47},{"diffs":[[0,"{\r\n    d"],[-1,"b"],[1,"atabases[database_name]"],[0,".destroy"]],"start1":161,"start2":161,"length1":17,"length2":39},{"diffs":[[0,"unction("],[1,"database_name, "],[0,"callback"]],"start1":392,"start2":392,"length1":16,"length2":31},{"diffs":[[0,"{\r\n    d"],[-1,"b"],[1,"atabases[database_name]"],[0,".create("]],"start1":425,"start2":425,"length1":17,"length2":39},{"diffs":[[0,"           d"],[-1,"b"],[1,"atabases[database_name]"],[0,".save(docs, "]],"start1":567,"start2":567,"length1":25,"length2":47},{"diffs":[[0,"ecurity("],[-1,""],[0,""],[1,"database_name, "],[0,"function"]],"start1":774,"start2":774,"length1":16,"length2":31},{"diffs":[[0,"ecurity("],[1,"database_name,"],[0,"callback"]],"start1":1213,"start2":1213,"length1":16,"length2":30},{"diffs":[[0,"{\r\n    d"],[-1,"b"],[1,"atabases[database_name]"],[0,".save(\"_"]],"start1":1245,"start2":1245,"length1":17,"length2":39},{"diffs":[[0,"ts.d"],[-1,"b = db"],[1,"atabases = databases"],[0,";\r\nm"]],"start1":1515,"start2":1515,"length1":14,"length2":28}]],"length":1612,"saved":false}
{"contributors":[],"silentsave":false,"ts":1349395340903,"patch":[[{"diffs":[[0,"var "],[-1,"docs = require('./../../config/database').documents,\r\n    "],[0,"data"]],"start1":0,"start2":0,"length1":66,"length2":8},{"diffs":[[0,"ase');\r\n"],[-1,"\r\n"],[0,"var rese"]],"start1":45,"start2":45,"length1":18,"length2":16},{"diffs":[[0,"  if (error) {\r\n"],[1,"            if (error.error == \"not_found\") {\r\n                createDb(database_name, callback)\r\n            }\r\n            else {\r\n"],[0,"            call"]],"start1":176,"start2":176,"length1":32,"length2":165},{"diffs":[[0,"response);\r\n"],[1,"            }\r\n"],[0,"        }\r\n "]],"start1":353,"start2":353,"length1":24,"length2":39},{"diffs":[[0,"reateDb("],[1,"database_name, "],[0,"callback"]],"start1":420,"start2":420,"length1":16,"length2":31},{"diffs":[[0,"ve(d"],[-1,"oc"],[1,"atabases[database_name].document"],[0,"s, f"]],"start1":708,"start2":708,"length1":10,"length2":40}]],"length":1745,"saved":false}
